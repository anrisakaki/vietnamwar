dn <- c("dn_prov.Rda", "dn_dist.Rda")

for (i in dn) {
  load(i)
}

bmr <- c("province_bmr_sum.Rda", "district_bmr_sum.Rda")

for (i in bmr) {
  load(i)
}

#############
# Firm level#
#############

# OLS

dn_ols_prov <- (list(
  feols(share_f ~ log(tot_bmr_prov),
        dn04,
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov),
        dn05,
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov),
        dn06,
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov),
        dn07,
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov),
        dn08,
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov),
        dn09,
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov),
        dn10,
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov),
        dn11,
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov),
        dn12,
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov),
        dn13,
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov),
        dn14,
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov),
        dn15,
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov),
        dn16,
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov),
        dn17,
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov),
        dn18,
        vcov = ~prov18)))

dn_ols_coef_prov<- lapply(dn_ols_prov, tidy)
dn_ols_coef_prov <- do.call(rbind, dn_ols_coef_prov)
dn_ols_coef_prov$year <- rep(seq(2004, 2018), each = nrow(dn_ols_coef_prov) / length(seq(2004, 2018)))
dn_ols_coef_prov <- dn_ols_coef_prov %>% filter(term != "(Intercept)")

## By south 
dn_ols_prov_n <- (list(
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn04, south == 0),
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn05, south == 0),
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn06, south == 0),
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn07, south == 0),
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn08, south == 0),
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn09, south == 0),
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn10, south == 0),
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn11, south == 0),
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn12, south == 0),
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn13, south == 0),
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn14, south == 0),
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn15, south == 0),
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn16, south == 0),
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn17, south == 0),
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn18, south == 0),
        vcov = ~prov18)))

dn_ols_prov_s <- (list(
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn04, south == 1),
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn05, south == 1),
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn06, south == 1),
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn07, south == 1),
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn08, south == 1),
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn09, south == 1),
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn10, south == 1),
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn11, south == 1),
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn12, south == 1),
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn13, south == 1),
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn14, south == 1),
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn15, south == 1),
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn16, south == 1),
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn17, south == 1),
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov),
        subset(dn18, south == 1),
        vcov = ~prov18)))

dn_ols_prov_coef_n <- lapply(dn_ols_prov_n, tidy)
dn_ols_prov_coef_s <- lapply(dn_ols_prov_s, tidy)
dn_ols_prov_coef_n <- do.call(rbind, dn_ols_prov_coef_n)
dn_ols_prov_coef_s <- do.call(rbind, dn_ols_prov_coef_s)
dn_ols_prov_coef_n$year <- rep(seq(2004, 2018), each = nrow(dn_ols_prov_coef_n) / length(seq(2004, 2018)))
dn_ols_prov_coef_s$year <- rep(seq(2004, 2018), each = nrow(dn_ols_prov_coef_s) / length(seq(2004, 2018)))

dn_ols_prov_coef_n$group <- "North"
dn_ols_prov_coef_s$group <- "South"
dn_ols_prov_coef_ns <- rbind(dn_ols_prov_coef_n, dn_ols_prov_coef_s)
dn_ols_prov_coef_ns <- dn_ols_prov_coef_ns %>% filter(term != "(Intercept)")

# Industry Fixed effects 
dn_indfe_prov <- (list(
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        dn04,
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn05,
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn06,
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn07,
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn08,
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn09,
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn10,
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn11,
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn12,
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn13,
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn14,
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn15,
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn16,
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn17,
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        dn18,
        vcov = ~prov18)))

dn_indfe_prov_coef <- lapply(dn_indfe_prov, tidy)
dn_indfe_prov_coef <- do.call(rbind, dn_indfe_prov_coef)
dn_indfe_prov_coef$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_prov_coef) / length(seq(2004, 2018)))
dn_indfe_prov_coef <- dn_indfe_prov_coef %>% filter(term != "(Intercept)")

## By north/south 
dn_indfe_prov_n <- (list(
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn04, south == 0),
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn05, south == 0),
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn06, south == 0),
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn07, south == 0),
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn08, south == 0),
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn09, south == 0),
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn10, south == 0),
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn11, south == 0),
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn12, south == 0),
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn13, south == 0),
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn14, south == 0),
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn15, south == 0),
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn16, south == 0),
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn17, south == 0),
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn18, south == 0),
        vcov = ~prov18)))

dn_indfe_prov_s <- (list(
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn04, south == 1),
        vcov = ~prov04),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn05, south == 1),
        vcov = ~prov05),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn06, south == 1),
        vcov = ~prov06),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn07, south == 1),
        vcov = ~prov07),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn08, south == 1),
        vcov = ~prov08),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn09, south == 1),
        vcov = ~prov09),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn10, south == 1),
        vcov = ~prov10),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn11, south == 1),
        vcov = ~prov11),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn12, south == 1),
        vcov = ~prov12),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn13, south == 1),
        vcov = ~prov13),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn14, south == 1),
        vcov = ~prov14),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn15, south == 1),
        vcov = ~prov15),
  feols(share_f ~ log(tot_bmr_prov) | nganh_kd,
        subset(dn16, south == 1),
        vcov = ~prov16),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        subset(dn17, south == 1),
        vcov = ~prov17),
  feols(share_f ~ log(tot_bmr_prov)| nganh_kd,
        subset(dn18, south == 1) ,
        vcov = ~prov18)))

dn_indfe_prov_coef_n <- lapply(dn_indfe_prov_n, tidy)
dn_indfe_prov_coef_s <- lapply(dn_indfe_prov_s, tidy)
dn_indfe_prov_coef_n <- do.call(rbind, dn_indfe_prov_coef_n)
dn_indfe_prov_coef_s <- do.call(rbind, dn_indfe_prov_coef_s)
dn_indfe_prov_coef_n$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_prov_coef_n) / length(seq(2004, 2018)))
dn_indfe_prov_coef_s$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_prov_coef_s) / length(seq(2004, 2018)))

dn_indfe_prov_coef_n$group <- "North"
dn_indfe_prov_coef_s$group <- "South"
dn_indfe_prov_coef_ns <- rbind(dn_indfe_prov_coef_n, dn_indfe_prov_coef_s)
dn_indfe_prov_coef_ns <- dn_indfe_prov_coef_ns %>% filter(term != "(Intercept)")

#################
# Province level#
#################

# OLS

dn_prov_ols_models <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018),
        vcov = ~prov2018)))

dn_prov_ols_coef <- lapply(dn_prov_ols_models, tidy)
dn_prov_ols_coef <- do.call(rbind, dn_prov_ols_coef)
dn_prov_ols_coef$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef) / length(seq(2000, 2018)))
dn_prov_ols_coef <- dn_prov_ols_coef %>% filter(term != "(Intercept)")

By # South 

dn_prov_ols_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 0),
        vcov = ~prov2018)))

dn_prov_ols_coef_s <- lapply(dn_prov_ols_s, tidy)
dn_prov_ols_coef_s <- do.call(rbind, dn_prov_ols_coef_s)
dn_prov_ols_coef_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_s) / length(seq(2000, 2018)))

dn_prov_ols_coef_n <- lapply(dn_prov_ols_n, tidy)
dn_prov_ols_coef_n <- do.call(rbind, dn_prov_ols_coef_n)
dn_prov_ols_coef_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_n) / length(seq(2000, 2018)))

dn_prov_ols_coef_n$group <- "North"
dn_prov_ols_coef_s$group <- "South"
dn_prov_ols_coef_ns <- rbind(dn_prov_ols_coef_n, dn_prov_ols_coef_s)
dn_prov_ols_coef_ns <- dn_prov_ols_coef_ns %>% filter(term != "(Intercept)")

# Industry 

dn_prov_ols_agri <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture"),
        vcov = ~prov2018)))

dn_prov_olscoef_agri <- lapply(dn_prov_ols_agri, tidy)
dn_prov_olscoef_agri <- do.call(rbind, dn_prov_olscoef_agri)
dn_prov_olscoef_agri$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri) / length(seq(2000, 2018)))
dn_prov_olscoef_agri <- dn_prov_olscoef_agri %>% filter(term != "(Intercept)")

dn_prov_ols_manu <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing"),
        vcov = ~prov2018)))

dn_prov_olscoef_manu <- lapply(dn_prov_ols_manu, tidy)
dn_prov_olscoef_manu <- do.call(rbind, dn_prov_olscoef_manu)
dn_prov_olscoef_manu$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu) / length(seq(2000, 2018)))
dn_prov_olscoef_manu <- dn_prov_olscoef_manu %>% filter(term != "(Intercept)")

# By industry - south

dn_prov_ols_agri_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_agri_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018)))

dn_prov_olscoef_agri_s <- lapply(dn_prov_ols_agri_s, tidy)
dn_prov_olscoef_agri_n <- lapply(dn_prov_ols_agri_n, tidy)
dn_prov_olscoef_agri_s <- do.call(rbind, dn_prov_olscoef_agri_s)
dn_prov_olscoef_agri_n <- do.call(rbind, dn_prov_olscoef_agri_n)
dn_prov_olscoef_agri_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri_s) / length(seq(2000, 2018)))
dn_prov_olscoef_agri_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri_n) / length(seq(2000, 2018)))

dn_prov_olscoef_agri_n$group <- "North"
dn_prov_olscoef_agri_s$group <- "South"
dn_prov_olscoef_agri_ns <- rbind(dn_prov_olscoef_agri_n, dn_prov_olscoef_agri_s)
dn_prov_olscoef_agri_ns <- dn_prov_olscoef_agri_ns %>% filter(term != "(Intercept)")

dn_prov_ols_manu_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_manu_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018)))

dn_prov_olscoef_manu_s <- lapply(dn_prov_ols_manu_s, tidy)
dn_prov_olscoef_manu_n <- lapply(dn_prov_ols_manu_n, tidy)
dn_prov_olscoef_manu_s <- do.call(rbind, dn_prov_olscoef_manu_s)
dn_prov_olscoef_manu_n <- do.call(rbind, dn_prov_olscoef_manu_n)
dn_prov_olscoef_manu_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu_s) / length(seq(2000, 2018)))
dn_prov_olscoef_manu_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu_n) / length(seq(2000, 2018)))

dn_prov_olscoef_manu_n$group <- "North"
dn_prov_olscoef_manu_s$group <- "South"
dn_prov_olscoef_manu_ns <- rbind(dn_prov_olscoef_manu_n, dn_prov_olscoef_manu_s)
dn_prov_olscoef_manu_ns <- dn_prov_olscoef_manu_ns %>% filter(term != "(Intercept)")
