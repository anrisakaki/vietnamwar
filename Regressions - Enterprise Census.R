dn <- c("dn_prov.Rda", "dn_dist.Rda")

for (i in dn) {
  load(i)
}

bmr <- c("province_bmr_sum.Rda", "district_bmr_sum.Rda")

for (i in bmr) {
  load(i)
}

#################
# District level#
#################

# OLS

dn_dist_ols <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2000),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2001),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2002),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2003),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018),
        vcov = ~dist2018)))

dn_dist_ols_coef <- lapply(dn_dist_ols, tidy)
dn_dist_ols_coef_df <- do.call(rbind, dn_dist_ols_coef)
dn_dist_ols_coef_df$year <- rep(seq(2000, 2018), each = nrow(dn_dist_ols_coef_df) / length(seq(2000, 2018)))
dn_dist_ols_coef_df <- dn_dist_ols_coef_df %>% filter(term != "(Intercept)")

## By north/south

dn_dist_ols_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2000 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2001 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2002 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2003 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018 & south == 1),
        vcov = ~dist2018)))

dn_dist_ols_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2000 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2001 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2002 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2003 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018 & south == 0),
        vcov = ~dist2018)))

dn_dist_ols_coef_n <- lapply(dn_dist_ols_n, tidy)
dn_dist_ols_coef_s <- lapply(dn_dist_ols_s, tidy)
dn_dist_ols_coef_n <- do.call(rbind, dn_dist_ols_coef_n)
dn_dist_ols_coef_s <- do.call(rbind, dn_dist_ols_coef_s)
dn_dist_ols_coef_s$year <- rep(seq(2000, 2018), each = nrow(dn_dist_ols_coef_s) / length(seq(2000, 2018)))
dn_dist_ols_coef_n$year <- rep(seq(2000, 2018), each = nrow(dn_dist_ols_coef_n) / length(seq(2000, 2018)))

dn_dist_ols_coef_n$group <- "North"
dn_dist_ols_coef_s$group <- "South"
dn_dist_ols_coef_ns <- rbind(dn_dist_ols_coef_n, dn_dist_ols_coef_s)
dn_dist_ols_coef_ns <- dn_dist_ols_coef_ns %>% filter(term != "(Intercept)")

# By industry 

dn_dist_ols_agri <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Agriculture"),
        vcov = ~dist2018)))

dn_dist_olscoef_agri <- lapply(dn_dist_ols_agri, tidy)
dn_dist_olscoef_agri <- do.call(rbind, dn_dist_olscoef_agri)
dn_dist_olscoef_agri$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_agri) / length(seq(2000, 2018)))
dn_dist_olscoef_agri <- dn_dist_olscoef_agri %>% filter(term != "(Intercept)")

dn_dist_ols_manu <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Manufacturing"),
        vcov = ~dist2018)))

dn_dist_olscoef_manu <- lapply(dn_dist_ols_manu, tidy)
dn_dist_olscoef_manu <- do.call(rbind, dn_dist_olscoef_manu)
dn_dist_olscoef_manu$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_manu) / length(seq(2000, 2018)))
dn_dist_olscoef_manu <- dn_dist_olscoef_manu %>% filter(term != "(Intercept)")

# By industry & south 

dn_dist_ols_agri_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Agriculture" & south == 1),
        vcov = ~dist2018)))

dn_dist_ols_agri_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Agriculture" & south == 0),
        vcov = ~dist2018)))

dn_dist_olscoef_agri_n <- lapply(dn_dist_ols_agri_n, tidy)
dn_dist_olscoef_agri_s <- lapply(dn_dist_ols_agri_s, tidy)
dn_dist_olscoef_agri_n <- do.call(rbind, dn_dist_olscoef_agri_n)
dn_dist_olscoef_agri_s <- do.call(rbind, dn_dist_olscoef_agri_s)
dn_dist_olscoef_agri_n$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_agri_n) / length(seq(2000, 2018)))
dn_dist_olscoef_agri_s$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_agri_s) / length(seq(2000, 2018)))

dn_dist_olscoef_agri_n$group <- "North"
dn_dist_olscoef_agri_s$group <- "South"
dn_dist_olscoef_agri_ns <- rbind(dn_dist_olscoef_agri_n, dn_dist_olscoef_agri_s)
dn_dist_olscoef_agri_ns <- dn_dist_ols_coef_ns %>% filter(term != "(Intercept)")

dn_dist_ols_manu_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Manufacturing" & south == 1),
        vcov = ~dist2018)))

dn_dist_ols_manu_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2000 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2001 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2002 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2003 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2004 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2005 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2006 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2007 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2009 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2010 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2011 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2012 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2013 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2014 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2015 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2016 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2017 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2018 & industry == "Manufacturing" & south == 0),
        vcov = ~dist2018)))

dn_dist_olscoef_manu_n <- lapply(dn_dist_ols_manu_n, tidy)
dn_dist_olscoef_manu_s <- lapply(dn_dist_ols_manu_s, tidy)
dn_dist_olscoef_manu_n <- do.call(rbind, dn_dist_olscoef_manu_n)
dn_dist_olscoef_manu_s <- do.call(rbind, dn_dist_olscoef_manu_s)
dn_dist_olscoef_manu_n$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_manu_n) / length(seq(2000, 2018)))
dn_dist_olscoef_manu_s$year <- rep(seq(2000, 2018), each = nrow(dn_dist_olscoef_manu_s) / length(seq(2000, 2018)))

dn_dist_olscoef_manu_n$group <- "North"
dn_dist_olscoef_manu_s$group <- "South"
dn_dist_olscoef_manu_ns <- rbind(dn_dist_olscoef_manu_n, dn_dist_olscoef_manu_s)
dn_dist_olscoef_manu_ns <- dn_dist_olscoef_manu_ns %>% filter(term != "(Intercept)")

# Province FE 

dn_dist_femodels <- (list(
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2000),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2001),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2002),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2003),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2004),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2005),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2006),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2007),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2008),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2009),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2010),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2011),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2012),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2013),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2014),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2015),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2016),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2017),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2018),
        vcov = ~dist2018)))

dn_dist_fecoef <- lapply(dn_dist_femodels, tidy)
dn_dist_fecoef_df <- do.call(rbind, dn_dist_fecoef)
dn_dist_fecoef_df$year <- rep(seq(2000, 2018), each = nrow(dn_dist_fecoef_df) / length(seq(2000, 2018)))

# By South

dn_dist_femodels_s <- (list(
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2000 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2001 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2002 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2003 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2004 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2005 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2006 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2007 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2008 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2009 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2010 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2011 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2012 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2013 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2014 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2015 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2016 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2017 & south == 1),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2018 & south == 1),
        vcov = ~dist2018)))

dn_dist_femodels_n <- (list(
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2000 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2001 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2002 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2003 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2004 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2005 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2006 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2007 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2008 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2009 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2010 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2011 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2012 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2013 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2014 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2015 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2016 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2017 & south == 0),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist, year == 2018 & south == 0),
        vcov = ~dist2018)))

dn_dist_fecoef_n <- lapply(dn_dist_femodels_n, tidy)
dn_dist_fecoef_s <- lapply(dn_dist_femodels_s, tidy)
dn_dist_fecoef_df_n <- do.call(rbind, dn_dist_fecoef_n)
dn_dist_fecoef_df_s <- do.call(rbind, dn_dist_fecoef_s)
dn_dist_fecoef_df_n$year <- rep(seq(2000, 2018), each = nrow(dn_dist_fecoef_df_n) / length(seq(2000, 2018)))
dn_dist_fecoef_df_s$year <- rep(seq(2000, 2018), each = nrow(dn_dist_fecoef_df_s) / length(seq(2000, 2018)))

dn_dist_fecoef_df_n$group <- "North"
dn_dist_fecoef_df_s$group <- "South"
dn_dist_fecoef_df_ns <- rbind(dn_dist_fecoef_df_n, dn_dist_fecoef_df_s)
dn_dist_fecoef_df_ns <- dn_dist_fecoef_df_ns %>% filter(term != "(Intercept)")

## By industry 

dn_dist_fe_agri <- (list(
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2000 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2001 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2002 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2003 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2004 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2005 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2006 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2007 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2009 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2010 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2011 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2012 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2013 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2014 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2015 & industry == "Agriculture"),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2016 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2017 & industry == "Agriculture"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2018 & industry == "Agriculture"),
        vcov = ~dist2018)))

dn_dist_fecoef_agri <- lapply(dn_dist_fe_agri, tidy)
dn_dist_fecoef_agri <- do.call(rbind, dn_dist_fecoef_agri)
dn_dist_fecoef_agri$year <- rep(seq(2000, 2018), each = nrow(dn_dist_fecoef_agri) / length(seq(2000, 2018)))
dn_dist_fecoef_agri <- dn_dist_fecoef_agri %>% filter(term != "(Intercept)")

dn_dist_fe_manu <- (list(
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2000 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2001 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2002 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2003 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2004 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2005 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2006 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2007 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2009 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2010 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2011 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2012 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2013 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2014 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2015 & industry == "Manufacturing"),
        vcov = ~dist2018), 
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2016 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2017 & industry == "Manufacturing"),
        vcov = ~dist2018),
  feols(workerratio ~ log(tot_bmr) | prov2018,
        subset(dn_dist_ind, year == 2018 & industry == "Manufacturing"),
        vcov = ~dist2018)))

dn_dist_fecoef_manu <- lapply(dn_dist_fe_manu, tidy)
dn_dist_fecoef_manu <- do.call(rbind, dn_dist_fecoef_manu)
dn_dist_fecoef_manu$year <- rep(seq(2000, 2018), each = nrow(dn_dist_fecoef_manu) / length(seq(2000, 2018)))
dn_dist_fecoef_manu <- dn_dist_fecoef_manu %>% filter(term != "(Intercept)")

# Province level 

dn_prov_ols_models <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018),
        vcov = ~prov2018)))

dn_prov_ols_coef <- lapply(dn_prov_ols_models, tidy)
dn_prov_ols_coef <- do.call(rbind, dn_prov_ols_coef)
dn_prov_ols_coef$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef) / length(seq(2000, 2018)))
dn_prov_ols_coef <- dn_prov_ols_coef %>% filter(term != "(Intercept)")

## South 

dn_prov_ols_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 0),
        vcov = ~prov2018)))

dn_prov_ols_coef_s <- lapply(dn_prov_ols_s, tidy)
dn_prov_ols_coef_s <- do.call(rbind, dn_prov_ols_coef_s)
dn_prov_ols_coef_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_s) / length(seq(2000, 2018)))

dn_prov_ols_coef_n <- lapply(dn_prov_ols_n, tidy)
dn_prov_ols_coef_n <- do.call(rbind, dn_prov_ols_coef_n)
dn_prov_ols_coef_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_n) / length(seq(2000, 2018)))

dn_prov_ols_coef_n$group <- "North"
dn_prov_ols_coef_s$group <- "South"
dn_prov_ols_coef_ns <- rbind(dn_prov_ols_coef_n, dn_prov_ols_coef_s)
dn_prov_ols_coef_ns <- dn_prov_ols_coef_ns %>% filter(term != "(Intercept)")
