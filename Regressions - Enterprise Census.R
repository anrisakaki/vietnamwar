dn <- c("dn_prov.Rda", "dn_dist.Rda")

for (i in dn) {
  load(i)
}

bmr <- c("province_bmr_sum.Rda", "district_bmr_sum.Rda")

for (i in bmr) {
  load(i)
}

#############
# Firm level#
#############

# OLS

dn_ols <- (list(
  feols(share_f ~ log(tot_bmr),
        dn04,
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr),
        dn05,
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr),
        dn06,
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr),
        dn07,
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr),
        dn08,
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr),
        dn09,
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr),
        dn10,
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr),
        dn11,
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr),
        dn12,
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr),
        dn13,
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr),
        dn14,
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr),
        dn15,
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr),
        dn16,
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr),
        dn17,
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr),
        dn18,
        vcov = ~dist18)))

dn_ols_coef <- lapply(dn_ols, tidy)
dn_ols_coef <- do.call(rbind, dn_ols_coef)
dn_ols_coef$year <- rep(seq(2004, 2018), each = nrow(dn_ols_coef) / length(seq(2004, 2018)))
dn_ols_coef <- dn_ols_coef %>% filter(term != "(Intercept)")

## By south 

dn_ols_n <- (list(
  feols(share_f ~ log(tot_bmr),
        subset(dn04, south == 0),
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr),
        subset(dn05, south == 0),
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr),
        subset(dn06, south == 0),
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr),
        subset(dn07, south == 0),
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr),
        subset(dn08, south == 0),
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr),
        subset(dn09, south == 0),
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr),
        subset(dn10, south == 0),
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr),
        subset(dn11, south == 0),
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr),
        subset(dn12, south == 0),
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr),
        subset(dn13, south == 0),
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr),
        subset(dn14, south == 0),
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr),
        subset(dn15, south == 0),
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr),
        subset(dn16, south == 0),
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr),
        subset(dn17, south == 0),
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr),
        subset(dn18, south == 0),
        vcov = ~dist18)))

dn_ols_s <- (list(
  feols(share_f ~ log(tot_bmr),
        subset(dn04, south == 1),
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr),
        subset(dn05, south == 1),
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr),
        subset(dn06, south == 1),
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr),
        subset(dn07, south == 1),
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr),
        subset(dn08, south == 1),
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr),
        subset(dn09, south == 1),
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr),
        subset(dn10, south == 1),
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr),
        subset(dn11, south == 1),
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr),
        subset(dn12, south == 1),
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr),
        subset(dn13, south == 1),
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr),
        subset(dn14, south == 1),
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr),
        subset(dn15, south == 1),
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr),
        subset(dn16, south == 1),
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr),
        subset(dn17, south == 1),
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr),
        subset(dn18, south == 1),
        vcov = ~dist18)))

dn_ols_coef_n <- lapply(dn_ols_n, tidy)
dn_ols_coef_s <- lapply(dn_ols_s, tidy)
dn_ols_coef_n <- do.call(rbind, dn_ols_coef_n)
dn_ols_coef_s <- do.call(rbind, dn_ols_coef_s)
dn_ols_coef_n$year <- rep(seq(2004, 2018), each = nrow(dn_ols_coef_n) / length(seq(2004, 2018)))
dn_ols_coef_s$year <- rep(seq(2004, 2018), each = nrow(dn_ols_coef_s) / length(seq(2004, 2018)))

dn_ols_coef_n$group <- "North"
dn_ols_coef_s$group <- "South"
dn_ols_coef_ns <- rbind(dn_ols_coef_n, dn_ols_coef_s)
dn_ols_coef_ns <- dn_ols_coef_ns %>% filter(term != "(Intercept)")

# Industry Fixed effects 

dn_indfe <- (list(
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        dn04,
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn05,
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn06,
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn07,
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn08,
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn09,
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn10,
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn11,
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn12,
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn13,
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn14,
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn15,
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn16,
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn17,
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        dn18,
        vcov = ~dist18)))

dn_indfe_coef <- lapply(dn_indfe, tidy)
dn_indfe_coef <- do.call(rbind, dn_indfe_coef)
dn_indfe_coef$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_coef) / length(seq(2004, 2018)))
dn_indfe_coef <- dn_indfe_coef %>% filter(term != "(Intercept)")

## By north/south 

dn_indfe_n <- (list(
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn04, south == 0),
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn05, south == 0),
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn06, south == 0),
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn07, south == 0),
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn08, south == 0),
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn09, south == 0),
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn10, south == 0),
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn11, south == 0),
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn12, south == 0),
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn13, south == 0),
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn14, south == 0),
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn15, south == 0),
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn16, south == 0),
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn17, south == 0),
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn18, south == 0),
        vcov = ~dist18)))

dn_indfe_s <- (list(
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn04, south == 1),
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn05, south == 1),
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn06, south == 1),
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn07, south == 1),
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn08, south == 1),
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn09, south == 1),
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn10, south == 1),
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn11, south == 1),
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn12, south == 1),
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn13, south == 1),
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn14, south == 1),
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn15, south == 1),
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr) | nganh_kd,
        subset(dn16, south == 1),
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        subset(dn17, south == 1),
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr)| nganh_kd,
        subset(dn18, south == 1) ,
        vcov = ~dist18)))

dn_indfe_coef_n <- lapply(dn_indfe_n, tidy)
dn_indfe_coef_s <- lapply(dn_indfe_s, tidy)
dn_indfe_coef_n <- do.call(rbind, dn_indfe_coef_n)
dn_indfe_coef_s <- do.call(rbind, dn_indfe_coef_s)
dn_indfe_coef_s$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_coef_s) / length(seq(2004, 2018)))
dn_indfe_coef_n$year <- rep(seq(2004, 2018), each = nrow(dn_indfe_coef_n) / length(seq(2004, 2018)))

dn_indfe_coef_n$group <- "North"
dn_indfe_coef_s$group <- "South"
dn_indfe_coef_ns <- rbind(dn_indfe_coef_n, dn_indfe_coef_s)
dn_indfe_coef_ns <- dn_indfe_coef_ns %>% filter(term != "(Intercept)")

# Province and industry FE 

dn_provindfe <- (list(
  feols(share_f ~ log(tot_bmr) | nganh_kd + prov04,
        dn04,
        vcov = ~dist04),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov05,
        dn05,
        vcov = ~dist05),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov06,
        dn06,
        vcov = ~dist06),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov07,
        dn07,
        vcov = ~dist07),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov08,
        dn08,
        vcov = ~dist08),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov09,
        dn09,
        vcov = ~dist09),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov10,
        dn10,
        vcov = ~dist10),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov11,
        dn11,
        vcov = ~dist11),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov12,
        dn12,
        vcov = ~dist12),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov13,
        dn13,
        vcov = ~dist13),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov14,
        dn14,
        vcov = ~dist14),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov15,
        dn15,
        vcov = ~dist15),
  feols(share_f ~ log(tot_bmr)| nganh_kd  + prov16,
        dn16,
        vcov = ~dist16),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov17,
        dn17,
        vcov = ~dist17),
  feols(share_f ~ log(tot_bmr)| nganh_kd + prov18,
        dn18,
        vcov = ~dist18)))

dn_provindfe_coef <- lapply(dn_provindfe, tidy)
dn_provindfe_coef <- do.call(rbind, dn_provindfe_coef)
dn_provindfe_coef$year <- rep(seq(2004, 2018), each = nrow(dn_provindfe_coef) / length(seq(2004, 2018)))
dn_provindfe_coef <- dn_provindfe_coef %>% filter(term != "(Intercept)")

#################
# District level#
#################

# OLS

dn_dist_ols <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018),
        vcov = ~dist18)))

dn_dist_ols_coef <- lapply(dn_dist_ols, tidy)
dn_dist_ols_coef_df <- do.call(rbind, dn_dist_ols_coef)
dn_dist_ols_coef_df$year <- rep(seq(2004, 2018), each = nrow(dn_dist_ols_coef_df) / length(seq(2004, 2018)))
dn_dist_ols_coef_df <- dn_dist_ols_coef_df %>% filter(term != "(Intercept)")

## By north/south

dn_dist_ols_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004 & south == 1),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005 & south == 1),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006 & south == 1),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007 & south == 1),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008 & south == 1),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009 & south == 1),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010 & south == 1),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011 & south == 1),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012 & south == 1),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013 & south == 1),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014 & south == 1),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015 & south == 1),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016 & south == 1),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017 & south == 1),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018 & south == 1),
        vcov = ~dist18)))

dn_dist_ols_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2004 & south == 0),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2005 & south == 0),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2006 & south == 0),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2007 & south == 0),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2008 & south == 0),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2009 & south == 0),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2010 & south == 0),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2011 & south == 0),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2012 & south == 0),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2013 & south == 0),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2014 & south == 0),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2015 & south == 0),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2016 & south == 0),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2017 & south == 0),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist, year == 2018 & south == 0),
        vcov = ~dist18)))

dn_dist_ols_coef_n <- lapply(dn_dist_ols_n, tidy)
dn_dist_ols_coef_s <- lapply(dn_dist_ols_s, tidy)
dn_dist_ols_coef_n <- do.call(rbind, dn_dist_ols_coef_n)
dn_dist_ols_coef_s <- do.call(rbind, dn_dist_ols_coef_s)
dn_dist_ols_coef_s$year <- rep(seq(2004, 2018), each = nrow(dn_dist_ols_coef_s) / length(seq(2004, 2018)))
dn_dist_ols_coef_n$year <- rep(seq(2004, 2018), each = nrow(dn_dist_ols_coef_n) / length(seq(2004, 2018)))

dn_dist_ols_coef_n$group <- "North"
dn_dist_ols_coef_s$group <- "South"
dn_dist_ols_coef_ns <- rbind(dn_dist_ols_coef_n, dn_dist_ols_coef_s)
dn_dist_ols_coef_ns <- dn_dist_ols_coef_ns %>% filter(term != "(Intercept)")

# Province FE 

dn_dist_femodels <- (list(
  feols(workerratio ~ log(tot_bmr) | prov04,
        subset(dn_dist, year == 2004),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr) | prov05,
        subset(dn_dist, year == 2005),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr) | prov06,
        subset(dn_dist, year == 2006),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr) | prov07,
        subset(dn_dist, year == 2007),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr) | prov08,
        subset(dn_dist, year == 2008),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr) | prov09,
        subset(dn_dist, year == 2009),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr) | prov10,
        subset(dn_dist, year == 2010),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr) | prov11,
        subset(dn_dist, year == 2011),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr) | prov12,
        subset(dn_dist, year == 2012),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr) | prov13,
        subset(dn_dist, year == 2013),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr) | prov14,
        subset(dn_dist, year == 2014),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr) | prov15,
        subset(dn_dist, year == 2015),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr) | prov16,
        subset(dn_dist, year == 2016),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr) | prov17,
        subset(dn_dist, year == 2017),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr) | prov18,
        subset(dn_dist, year == 2018),
        vcov = ~dist18)))

dn_dist_fecoef <- lapply(dn_dist_femodels, tidy)
dn_dist_fecoef_df <- do.call(rbind, dn_dist_fecoef)
dn_dist_fecoef_df$year <- rep(seq(2004, 2018), each = nrow(dn_dist_fecoef_df) / length(seq(2004, 2018)))

# By South

dn_dist_femodels_s <- (list(
  feols(workerratio ~ log(tot_bmr) | prov04,
        subset(dn_dist, year == 2004 & south == 1),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr) | prov05,
        subset(dn_dist, year == 2005 & south == 1),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr) | prov06,
        subset(dn_dist, year == 2006 & south == 1),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr) | prov07,
        subset(dn_dist, year == 2007 & south == 1),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr) | prov08,
        subset(dn_dist, year == 2008 & south == 1),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr) | prov09,
        subset(dn_dist, year == 2009 & south == 1),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr) | prov10,
        subset(dn_dist, year == 2010 & south == 1),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr) | prov11,
        subset(dn_dist, year == 2011 & south == 1),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr) | prov12,
        subset(dn_dist, year == 2012 & south == 1),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr) | prov13,
        subset(dn_dist, year == 2013 & south == 1),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr) | prov14,
        subset(dn_dist, year == 2014 & south == 1),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr) | prov15,
        subset(dn_dist, year == 2015 & south == 1),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr) | prov16,
        subset(dn_dist, year == 2016 & south == 1),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr) | prov17,
        subset(dn_dist, year == 2017 & south == 1),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr) | prov18,
        subset(dn_dist, year == 2018 & south == 1),
        vcov = ~dist18)))

dn_dist_femodels_n <- (list(
  feols(workerratio ~ log(tot_bmr) | prov04,
        subset(dn_dist, year == 2004 & south == 0),
        vcov = ~dist04),
  feols(workerratio ~ log(tot_bmr) | prov05,
        subset(dn_dist, year == 2005 & south == 0),
        vcov = ~dist05),
  feols(workerratio ~ log(tot_bmr) | prov06,
        subset(dn_dist, year == 2006 & south == 0),
        vcov = ~dist06),
  feols(workerratio ~ log(tot_bmr) | prov07,
        subset(dn_dist, year == 2007 & south == 0),
        vcov = ~dist07),
  feols(workerratio ~ log(tot_bmr) | prov08,
        subset(dn_dist, year == 2008 & south == 0),
        vcov = ~dist08),
  feols(workerratio ~ log(tot_bmr) | prov09,
        subset(dn_dist, year == 2009 & south == 0),
        vcov = ~dist09),
  feols(workerratio ~ log(tot_bmr) | prov10,
        subset(dn_dist, year == 2010 & south == 0),
        vcov = ~dist10),
  feols(workerratio ~ log(tot_bmr) | prov11,
        subset(dn_dist, year == 2011 & south == 0),
        vcov = ~dist11),
  feols(workerratio ~ log(tot_bmr) | prov12,
        subset(dn_dist, year == 2012 & south == 0),
        vcov = ~dist12),
  feols(workerratio ~ log(tot_bmr) | prov13,
        subset(dn_dist, year == 2013 & south == 0),
        vcov = ~dist13),
  feols(workerratio ~ log(tot_bmr) | prov14,
        subset(dn_dist, year == 2014 & south == 0),
        vcov = ~dist14),
  feols(workerratio ~ log(tot_bmr) | prov15,
        subset(dn_dist, year == 2015 & south == 0),
        vcov = ~dist15),
  feols(workerratio ~ log(tot_bmr) | prov16,
        subset(dn_dist, year == 2016 & south == 0),
        vcov = ~dist16),
  feols(workerratio ~ log(tot_bmr) | prov17,
        subset(dn_dist, year == 2017 & south == 0),
        vcov = ~dist17),
  feols(workerratio ~ log(tot_bmr) | prov18,
        subset(dn_dist, year == 2018 & south == 0),
        vcov = ~dist18)))

dn_dist_fecoef_n <- lapply(dn_dist_femodels_n, tidy)
dn_dist_fecoef_s <- lapply(dn_dist_femodels_s, tidy)
dn_dist_fecoef_df_n <- do.call(rbind, dn_dist_fecoef_n)
dn_dist_fecoef_df_s <- do.call(rbind, dn_dist_fecoef_s)
dn_dist_fecoef_df_n$year <- rep(seq(2004, 2018), each = nrow(dn_dist_fecoef_df_n) / length(seq(2004, 2018)))
dn_dist_fecoef_df_s$year <- rep(seq(2004, 2018), each = nrow(dn_dist_fecoef_df_s) / length(seq(2004, 2018)))

dn_dist_fecoef_df_n$group <- "North"
dn_dist_fecoef_df_s$group <- "South"
dn_dist_fecoef_df_ns <- rbind(dn_dist_fecoef_df_n, dn_dist_fecoef_df_s)
dn_dist_fecoef_df_ns <- dn_dist_fecoef_df_ns %>% filter(term != "(Intercept)")

# Province level 

dn_prov_ols_models <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018),
        vcov = ~prov2018)))

dn_prov_ols_coef <- lapply(dn_prov_ols_models, tidy)
dn_prov_ols_coef <- do.call(rbind, dn_prov_ols_coef)
dn_prov_ols_coef$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef) / length(seq(2000, 2018)))
dn_prov_ols_coef <- dn_prov_ols_coef %>% filter(term != "(Intercept)")

By # South 

dn_prov_ols_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2000 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2001 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2002 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2003 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2004 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2005 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2006 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2007 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2008 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2009 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2010 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2011 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2012 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2013 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2014 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2015 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2016 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2017 & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov, year == 2018 & south == 0),
        vcov = ~prov2018)))

dn_prov_ols_coef_s <- lapply(dn_prov_ols_s, tidy)
dn_prov_ols_coef_s <- do.call(rbind, dn_prov_ols_coef_s)
dn_prov_ols_coef_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_s) / length(seq(2000, 2018)))

dn_prov_ols_coef_n <- lapply(dn_prov_ols_n, tidy)
dn_prov_ols_coef_n <- do.call(rbind, dn_prov_ols_coef_n)
dn_prov_ols_coef_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_ols_coef_n) / length(seq(2000, 2018)))

dn_prov_ols_coef_n$group <- "North"
dn_prov_ols_coef_s$group <- "South"
dn_prov_ols_coef_ns <- rbind(dn_prov_ols_coef_n, dn_prov_ols_coef_s)
dn_prov_ols_coef_ns <- dn_prov_ols_coef_ns %>% filter(term != "(Intercept)")

# Industry 

dn_prov_ols_agri <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture"),
        vcov = ~prov2018)))

dn_prov_olscoef_agri <- lapply(dn_prov_ols_agri, tidy)
dn_prov_olscoef_agri <- do.call(rbind, dn_prov_olscoef_agri)
dn_prov_olscoef_agri$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri) / length(seq(2000, 2018)))
dn_prov_olscoef_agri <- dn_prov_olscoef_agri %>% filter(term != "(Intercept)")

dn_prov_ols_manu <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing"),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing"),
        vcov = ~prov2018)))

dn_prov_olscoef_manu <- lapply(dn_prov_ols_manu, tidy)
dn_prov_olscoef_manu <- do.call(rbind, dn_prov_olscoef_manu)
dn_prov_olscoef_manu$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu) / length(seq(2000, 2018)))
dn_prov_olscoef_manu <- dn_prov_olscoef_manu %>% filter(term != "(Intercept)")

# By industry - south

dn_prov_ols_agri_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture" & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_agri_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Agriculture" & south == 0),
        vcov = ~prov2018)))

dn_prov_olscoef_agri_s <- lapply(dn_prov_ols_agri_s, tidy)
dn_prov_olscoef_agri_n <- lapply(dn_prov_ols_agri_n, tidy)
dn_prov_olscoef_agri_s <- do.call(rbind, dn_prov_olscoef_agri_s)
dn_prov_olscoef_agri_n <- do.call(rbind, dn_prov_olscoef_agri_n)
dn_prov_olscoef_agri_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri_s) / length(seq(2000, 2018)))
dn_prov_olscoef_agri_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_agri_n) / length(seq(2000, 2018)))

dn_prov_olscoef_agri_n$group <- "North"
dn_prov_olscoef_agri_s$group <- "South"
dn_prov_olscoef_agri_ns <- rbind(dn_prov_olscoef_agri_n, dn_prov_olscoef_agri_s)
dn_prov_olscoef_agri_ns <- dn_prov_olscoef_agri_ns %>% filter(term != "(Intercept)")

dn_prov_ols_manu_s <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing" & south == 1),
        vcov = ~prov2018)))

dn_prov_ols_manu_n <- (list(
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2000 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2001 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2002 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2003 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2004 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2005 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2006 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2007 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_dist_ind, year == 2008 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2009 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2010 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2011 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2012 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2013 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2014 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2015 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2016 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2017 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018),
  feols(workerratio ~ log(tot_bmr),
        subset(dn_prov_ind, year == 2018 & industry == "Manufacturing" & south == 0),
        vcov = ~prov2018)))

dn_prov_olscoef_manu_s <- lapply(dn_prov_ols_manu_s, tidy)
dn_prov_olscoef_manu_n <- lapply(dn_prov_ols_manu_n, tidy)
dn_prov_olscoef_manu_s <- do.call(rbind, dn_prov_olscoef_manu_s)
dn_prov_olscoef_manu_n <- do.call(rbind, dn_prov_olscoef_manu_n)
dn_prov_olscoef_manu_s$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu_s) / length(seq(2000, 2018)))
dn_prov_olscoef_manu_n$year <- rep(seq(2000, 2018), each = nrow(dn_prov_olscoef_manu_n) / length(seq(2000, 2018)))

dn_prov_olscoef_manu_n$group <- "North"
dn_prov_olscoef_manu_s$group <- "South"
dn_prov_olscoef_manu_ns <- rbind(dn_prov_olscoef_manu_n, dn_prov_olscoef_manu_s)
dn_prov_olscoef_manu_ns <- dn_prov_olscoef_manu_ns %>% filter(term != "(Intercept)")
