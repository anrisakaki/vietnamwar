load("province_bmr_sum.Rda")

province_bmr_sum02 <- province_bmr_sum %>% 
  mutate(tinh02 = recode(name_1,
                         'An Giang' = 805,
                         'Bà Rịa - Vũng Tàu' = 717,
                         'Bắc Giang' = 221,
                         'Bắc Kạn' = 207,
                         'Bạc Liêu' = 821,
                         'Bắc Ninh' = 106,
                         'Bến Tre' = 811,
                         'Bình Định' = 507,
                         'Bình Dương' = 711,
                         'Bình Phước' = 707,
                         'Bình Thuận' = 715,
                         'Cà Mau' = 823,
                         'Cần Thơ' = 815,
                         'Hậu Giang' = 815,
                         'Cao Bằng' = 203,
                         'Đà Nẵng' = 501,
                         'Đắk Lắk' = 605,
                         'Đắk Nông' = 605,
                         'Điện Biên' = 301,
                         'Lai Châu' = 301,
                         'Đồng Nai' = 713,
                         'Đồng Tháp' = 803,
                         'Gia Lai' = 603,
                         'Hà Giang' = 201,
                         'Hà Nam' = 111,
                         'Hà Nội' = 101,
                         'Hà Tĩnh' = 405,
                         'Hải Dương' = 107,
                         'Hải Phòng' = 103,
                         'Hồ Chí Minh' = 701,
                         'Hoà Bình' = 305,
                         'Hưng Yên' = 109,
                         'Khánh Hòa' = 511,
                         'Kiên Giang' = 813,
                         'Kon Tum' = 601,
                         'Lâm Đồng' = 607,
                         'Lạng Sơn' = 209,
                         'Lào Cai' = 205,
                         'Long An' = 801,
                         'Nam Định' = 113,
                         'Nghệ An' = 403,
                         'Ninh Bình' = 117,
                         'Ninh Thuận' = 705,
                         'Phú Thọ' = 217,
                         'Phú Yên' = 509,
                         'Quảng Bình' = 407,
                         'Quảng Nam' = 503,
                         'Quảng Ngãi' = 505,
                         'Quảng Ninh' = 225,
                         'Quảng Trị' = 409,
                         'Sóc Trăng' = 819,
                         'Sơn La' = 303,
                         'Tây Ninh' = 709,
                         'Thái Bình' = 115,
                         'Thái Nguyên' = 215,
                         'Thanh Hóa' = 401,
                         'Thừa Thiên Huế' = 411,
                         'Tiền Giang' = 807,
                         'Trà Vinh' = 817,
                         'Tuyên Quang' = 211,
                         'Vĩnh Long' = 809,
                         'Vĩnh Phúc' = 104,
                         'Yên Bái' = 213,
                         .default = NA_real_)) %>% 
  ungroup() %>% 
  group_by(tinh02) %>% 
  summarise(tot_bmr_prov = sum(tot_bmr),
            tot_bmr_lb_prov = sum(tot_bmr_lb),
            killed_tot_prov = sum(killed_tot, na.rm = T),
            dist_nearest_base_prov = min(dist_nearest_base),
            dist_nearest_hochi_prov = min(dist_nearest_hochi)) %>% 
  mutate(killed_tot_prov = ifelse(killed_tot_prov == 0, NA, killed_tot_prov))

province_bmr_sum <- province_bmr_sum %>% 
  mutate(tinh = recode(name_1,
                       'An Giang' = 805,
                       'Bà Rịa - Vũng Tàu' = 717,
                       'Bắc Giang' = 221,
                       'Bắc Kạn' = 207,
                       'Bạc Liêu' = 821,
                       'Bắc Ninh' = 106,
                       'Bến Tre' = 811,
                       'Bình Định' = 507,
                       'Bình Dương' = 711,
                       'Bình Phước' = 707,
                       'Bình Thuận' = 715,
                       'Cà Mau' = 823,
                       'Cần Thơ' = 815,
                       'Hậu Giang' = 816,
                       'Cao Bằng' = 203,
                       'Đà Nẵng' = 501,
                       'Đắk Lắk' = 605,
                       'Đắk Nông' = 606,
                       'Điện Biên' = 302,
                       'Lai Châu' = 301,
                       'Đồng Nai' = 713,
                       'Đồng Tháp' = 803,
                       'Gia Lai' = 603,
                       'Hà Giang' = 201,
                       'Hà Nam' = 111,
                       'Hà Nội' = 101,
                       'Hà Tĩnh' = 405,
                       'Hải Dương' = 107,
                       'Hải Phòng' = 103,
                       'Hồ Chí Minh' = 701,
                       'Hoà Bình' = 305,
                       'Hưng Yên' = 109,
                       'Khánh Hòa' = 511,
                       'Kiên Giang' = 813,
                       'Kon Tum' = 601,
                       'Lâm Đồng' = 607,
                       'Lạng Sơn' = 209,
                       'Lào Cai' = 205,
                       'Long An' = 801,
                       'Nam Định' = 113,
                       'Nghệ An' = 403,
                       'Ninh Bình' = 117,
                       'Ninh Thuận' = 705,
                       'Phú Thọ' = 217,
                       'Phú Yên' = 509,
                       'Quảng Bình' = 407,
                       'Quảng Nam' = 503,
                       'Quảng Ngãi' = 505,
                       'Quảng Ninh' = 225,
                       'Quảng Trị' = 409,
                       'Sóc Trăng' = 819,
                       'Sơn La' = 303,
                       'Tây Ninh' = 709,
                       'Thái Bình' = 115,
                       'Thái Nguyên' = 215,
                       'Thanh Hóa' = 401,
                       'Thừa Thiên Huế' = 411,
                       'Tiền Giang' = 807,
                       'Trà Vinh' = 817,
                       'Tuyên Quang' = 211,
                       'Vĩnh Long' = 809,
                       'Vĩnh Phúc' = 104,
                       'Yên Bái' = 213,
                       .default = NA_real_)) %>% 
  rename_with(~if_else(. %in% c("tinh", "varname_1", "name_1", "provincename", "south"), 
                       ., paste0(., "_prov")), 
              -c(tinh, varname_1, name_1, provincename, south)) %>%
  select(-c(varname_1, provincename)) %>% 
  select(tinh, everything())


province_bmr_sum2 <- province_bmr_sum %>% 
  mutate(tinh = recode(name_1,
                       'An Giang' = 89,
                       'Bà Rịa - Vũng Tàu' = 77,
                       'Bắc Giang' = 24,
                       'Bắc Kạn' = 6,
                       'Bạc Liêu' = 95,
                       'Bắc Ninh' = 27,
                       'Bến Tre' = 83,
                       'Bình Định' = 52,
                       'Bình Dương' = 74,
                       'Bình Phước' = 70,
                       'Bình Thuận' = 60,
                       'Cà Mau' = 96,
                       'Cần Thơ' = 92,
                       'Hậu Giang' = 93,
                       'Cao Bằng' = 4,
                       'Đà Nẵng' = 48,
                       'Đắk Lắk' = 66,
                       'Đắk Nông' = 67,
                       'Điện Biên' = 11,
                       'Lai Châu' = 12,
                       'Đồng Nai' = 75,
                       'Đồng Tháp' = 87,
                       'Gia Lai' = 64,
                       'Hà Giang' = 2,
                       'Hà Nam' = 35,
                       'Hà Nội' = 1,
                       'Hà Tĩnh' = 42,
                       'Hải Dương' = 30,
                       'Hải Phòng' = 31,
                       'Hồ Chí Minh' = 79,
                       'Hoà Bình' = 17,
                       'Hưng Yên' = 33,
                       'Khánh Hòa' = 56,
                       'Kiên Giang' = 91,
                       'Kon Tum' = 62,
                       'Lâm Đồng' = 68,
                       'Lạng Sơn' = 20,
                       'Lào Cai' = 10,
                       'Long An' = 80,
                       'Nam Định' = 36,
                       'Nghệ An' = 40,
                       'Ninh Bình' = 37,
                       'Ninh Thuận' = 58,
                       'Phú Thọ' = 25,
                       'Phú Yên' = 54,
                       'Quảng Bình' = 44,
                       'Quảng Nam' = 49,
                       'Quảng Ngãi' = 51,
                       'Quảng Ninh' = 22,
                       'Quảng Trị' = 45,
                       'Sóc Trăng' = 94,
                       'Sơn La' = 14,
                       'Tây Ninh' = 72,
                       'Thái Bình' = 34,
                       'Thái Nguyên' = 19,
                       'Thanh Hóa' = 38,
                       'Thừa Thiên Huế' = 46,
                       'Tiền Giang' = 82,
                       'Trà Vinh' = 84,
                       'Tuyên Quang' = 8,
                       'Vĩnh Long' = 86,
                       'Vĩnh Phúc' = 26,
                       'Yên Bái' = 15,
                       .default = NA_real_)) %>% 
  group_by(tinh) %>% 
  summarise(tot_bmr_prov = sum(tot_bmr_prov),
            tot_bmr_lb_prov = sum(tot_bmr_lb_prov),
            killed_tot_prov = sum(killed_tot_prov, na.rm = T),
            dist_nearest_base_prov = min(dist_nearest_base_prov),
            dist_nearest_hochi_prov = min(dist_nearest_hochi_prov)) %>% 
  mutate(killed_tot_prov = ifelse(killed_tot_prov == 0, NA, killed_tot_prov))

save(province_bmr_sum02, file = "province_bmr_sum02.Rda")
save(province_bmr_sum, file = "province_bmr_sum.Rda")
save(province_bmr_sum2, file = "province_bmr_sum2.Rda")

province_bmr_sum0002 <- province_bmr_sum02 %>% 
  rename(tinh = tinh02)

province_bmr_sum0419 <- province_bmr_sum %>% 
  mutate(tinh = recode(name_1,
                       'An Giang' = 89,
                       'Bà Rịa - Vũng Tàu' = 77,
                       'Bắc Giang' = 24,
                       'Bắc Kạn' = 6,
                       'Bạc Liêu' = 95,
                       'Bắc Ninh' = 27,
                       'Bến Tre' = 83,
                       'Bình Định' = 52,
                       'Bình Dương' = 74,
                       'Bình Phước' = 70,
                       'Bình Thuận' = 60,
                       'Cà Mau' = 96,
                       'Cần Thơ' = 92,
                       'Hậu Giang' = 93,
                       'Cao Bằng' = 4,
                       'Đà Nẵng' = 48,
                       'Đắk Lắk' = 66,
                       'Đắk Nông' = 67,
                       'Điện Biên' = 11,
                       'Lai Châu' = 12,
                       'Đồng Nai' = 75,
                       'Đồng Tháp' = 87,
                       'Gia Lai' = 64,
                       'Hà Giang' = 2,
                       'Hà Nam' = 35,
                       'Hà Nội' = 1,
                       'Hà Tĩnh' = 42,
                       'Hải Dương' = 30,
                       'Hải Phòng' = 31,
                       'Hồ Chí Minh' = 79,
                       'Hoà Bình' = 17,
                       'Hưng Yên' = 33,
                       'Khánh Hòa' = 56,
                       'Kiên Giang' = 91,
                       'Kon Tum' = 62,
                       'Lâm Đồng' = 68,
                       'Lạng Sơn' = 20,
                       'Lào Cai' = 10,
                       'Long An' = 80,
                       'Nam Định' = 36,
                       'Nghệ An' = 40,
                       'Ninh Bình' = 37,
                       'Ninh Thuận' = 58,
                       'Phú Thọ' = 25,
                       'Phú Yên' = 54,
                       'Quảng Bình' = 44,
                       'Quảng Nam' = 49,
                       'Quảng Ngãi' = 51,
                       'Quảng Ninh' = 22,
                       'Quảng Trị' = 45,
                       'Sóc Trăng' = 94,
                       'Sơn La' = 14,
                       'Tây Ninh' = 72,
                       'Thái Bình' = 34,
                       'Thái Nguyên' = 19,
                       'Thanh Hóa' = 38,
                       'Thừa Thiên Huế' = 46,
                       'Tiền Giang' = 82,
                       'Trà Vinh' = 84,
                       'Tuyên Quang' = 8,
                       'Vĩnh Long' = 86,
                       'Vĩnh Phúc' = 26,
                       'Yên Bái' = 15,
                       .default = NA_real_))
